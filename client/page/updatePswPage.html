<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>修改您的密码</title>

        <link href="css/bootstrap.min.css" rel="stylesheet">
        <link href="css/updatePswPage.css" rel="stylesheet">
        
        <!-- 支持响应式布局 -->
         <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    </head>
    <body>
        <header>
            <div class="jumbotron">
                <p class="lead">
                    请设置您的新密码
                </p>
                <hr class="my-4">
                <a class="btn btn-primary btn-md" href="/index" >返回首页</a>
            </div>
        </header>
    
        <div class="container-fluid" id="main">
            <div class="row inputcomponent input-group mb-3">
                <div class="col-0 col-md-4"></div>
                <div class="col-12 col-md-4">
                    <div class="row">
                        <span class="input-group-text">账号:</span>
                    </div>
                    <div class="row">
                        <input type="text" id="userid" class="form-control" value="{userid}" aria-label="findaccount" disabled>
                    </div>
                
                    
                </div>
                <div class="col-0 col-md-4">
                    <div class="row d-none d-md-block">
                        <p>&nbsp;</p>   
                    </div>
                    <div class="row">
                        <p></p>
                    </div>
                </div>
                
            </div>  

            <div class="row inputcomponent input-group mb-3">
                <div class="col-0 col-md-4"></div>
                <div class="col-12 col-md-4">
                    <div class="row">
                        <span class="input-group-text">新密码:</span>
                    </div>
                    <div class="row">
                        <input type="password" id="usernewpassword" class="form-control" placeholder="请输入您要设置的新密码" aria-label="findaccount" >
                    </div>
                
                    
                </div>
                <div class="col-0 col-md-4">
                    <div class="row d-none d-md-block">
                        <p>&nbsp;</p>   
                    </div>
                    <div class="row">
                        <p></p>
                    </div>
                </div>
                
            </div>  

            <div class="row inputcomponent input-group mb-3">
                <div class="col-0 col-md-4"></div>
                <div class="col-12 col-md-4">
                    <div class="row">
                        <span class="input-group-text">确认密码:</span>
                    </div>
                    <div class="row">
                        <input type="password" id="confirmnewpassword" class="form-control" placeholder="确认您的新密码" aria-label="findaccount" >
                    </div>
                
                    
                </div>
                <div class="col-0 col-md-4">
                    <div class="row d-none d-md-block">
                        <p>&nbsp;</p>   
                    </div>
                    <div class="row">
                        <div class="col align-self-center">
                            <p></p>
                        </div>
                    </div>
                </div>
                
            </div>  


            <div class="row inputcomponent input-group mb-3">
                <div class="col-0 col-md-4"></div>
                <div class="col-12 col-md-4">
                    <div class="row">
                        <button class="btn btn-primary btn-md btn-block" id="submitnewpassword" type="submit" >提交信息</button>
                    </div>
                    
                </div>
                <div class="col-sm-0 col-md-4"></div>
            </div>
        </div>
        <script src="js/jquery.js"></script>
        <script src="js/bootstrap.js"></script>
        <script>

             $("#submitnewpassword").click(function() {

                if($("#usernewpassword").val()!=''  && $("#confirmnewpassword").val()){
                        if($("#usernewpassword").val()==$("#confirmnewpassword").val()){
                            let formObject = {};
                            formObject["userid"] = $("#userid").val();
                            formObject["usernewpassword"] = $("#usernewpassword").val();
                            
                            $.ajax({
                                url:"submitNewPassword",
                                type:"post",
                                contentType: "application/json; charset=utf-8",
                                data: JSON.stringify(formObject),
                                dataType: "json",
                                success:function(data){
                                    if(data.isValid){
                                        alert("修改成功，即将返回主页");
                                        window.open("/","_self");
                                    }else{
                                        alert("系统出现故障");
                                    }
                                },
                                error:function(e){
                                    alert("表单提交出现错误");
                                }
                            });
                        }
                        else{
                            alert("两次输入密码不一致");
                        }
                }
                else{
                    alert("请输入全部信息后再提交");
                }

            });
        </script>
    </body>
</html>